{% extends "base.html" %} {% import "bootstrap/wtf.html" as wtf %} {% block content %}
<form action="" method="post">
<div class="container-fluid">
    <div class="row">
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <ul class=flashes>
            {% for message in messages %}
              <li>{{ message }}</li>
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
        <div class="col-md-2" style="color:#EBEEF0;">
            <h3>Input Data</h3>
            <h6>*Select Input Data for one of the chosen scenarios</h6>
            <div class="button dropdown">
                  <select id="colorselector">
                      <option value="o">Select Input Data</option>
                      {% for o in range(0,2) %}
                      {% set y = loop.index - 1%}
                      {% set x = loop.index %}
                      <option value="o{{x}}">Input Data {{data_name[y]}}</option>
                      {% endfor %}
                  </select>
                </div>
            <div class="output">
                {% for m in range(0,2) %}
                {% set o = options[m] %}
                {% set t = loop.index%}
                <div class="colors" id="o{{t}}" style="padding-left: 20px;">
                    <div class="row">
                        <h4>Parameter des Models</h4>
                        <div class="col">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">Parameter</th>
                                        <th scope="col"># Number</th>
                                    </tr>
                                </thead>
                                <tbody>
                                   <tr>
                                        <th scope="row">Products</th>
                                        <td>{{ input[o]['nproducts']}}</td>
                                   </tr>
                                   <tr>
                                        <th scope="row">Sites</th>
                                        <td>{{ input[o]['nsites'] }}</td>
                                   </tr>
                                   <tr>
                                        <th scope="row">Demand Countries</th>
                                        <td>{{ input[o]['ncustomers'] }}</td>
                                   </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <h4>Profit Contribution</h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col"></th>
                                        {% for c in input[o]['cname'] %}
                                        <th scope="col">{{ c }}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in input[o]['pname'] %} {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ p }}</th>
                                        {% for j in range(0,input[o]['ncustomers']) %}
                                        {% if input['option1']['nproducts'] == input['option2']['nproducts'] and input['option1']['ncustomers'] == input['option2']['ncustomers'] %}
                                            {% if input['option1']['eb'][j][i] != input['option2']['eb'][j][i]%}
                                            <td bgcolor="#eab0a9">{{ input[o]['eb'][j][i] }}</td>
                                            {% else %}
                                            <td>{{ input[o]['eb'][j][i] }}</td>
                                            {% endif %}
                                        {% else %}
                                            <td>{{ input[o]['eb'][j][i] }}</td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <h4>Demand</h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col"></th>
                                        {% for c in input[o]['cname'] %}
                                        <th scope="col">{{ c }}</th>
                                        {% endfor %}
                                        <th scope="col">Sum Demand</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in input[o]['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ p }}</th>
                                        {% for j in range(0,input[o]['ncustomers']) %}
                                        {% if input['option1']['nproducts'] == input['option2']['nproducts'] and input['option1']['ncustomers'] == input['option2']['ncustomers'] %}
                                            {% if input['option1']['demand'][j][i] != input['option2']['demand'][j][i]%}
                                            <td bgcolor="#eab0a9">{{ input[o]['demand'][j][i] }}</td>
                                            {% else %}
                                            <td>{{ input[o]['demand'][j][i] }}</td>
                                            {% endif %}
                                        {% else %}
                                            <td>{{ input[o]['demand'][j][i] }}</td>
                                        {% endif %}
                                        {% endfor %}
                                        <td>{{ result['demand_per_Product'][i] }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h4>Excess Demand per Product </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">Product</th>
                                        <th scope="col">Excess Demand</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in input[o]['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{p}}</th>
                                         {% if input['option1']['excessdemand'][i] != input['option2']['excessdemand'][i]%}
                                        <td bgcolor="#eab0a9">{{ input[o]['excessdemand'][i] }}</td>
                                        {% else %}
                                        <td>{{ input[o]['excessdemand'][i] }}</td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h4>Max Production per Site </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">Site</th>
                                        <th scope="col">Number</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for s in input[o]['sname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{s}}</th>
                                        {% if input['option1']['maxProduction'][i] != input['option2']['maxProduction'][i]%}
                                        <td bgcolor="#eab0a9">{{ input[o]['maxProduction'][i] }}</td>
                                        {% else %}
                                        <td>{{ input[o]['maxProduction'][i] }}</td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h4>WLTP value per Car</h4>
                            <div class="chart-container">
                                <div class="col-md-12" style="padding-left:-200px; margin-left:-20px;">
                                    <canvas id="wltp{{t}}" width="40px" height="70px"></canvas>
                                </div>
                             </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h4>Weight per Car </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        <th scope="col">Weight</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in input[o]['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{p}}</th>
                                        {% if input['option1']['weight'][i] != input['option2']['weight'][i]%}
                                        <td bgcolor="#eab0a9">{{ input[o]['weight'][i] }} kg</td>
                                        {% else %}
                                        <td>{{ input[o]['weight'][i] }} kg</td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h4>Supercredit per Car </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        <th scope="col">Supercredit</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in input[o]['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{p}}</th>
                                        {% if input['option1']['supercredit'][i] != input['option2']['supercredit'][i]%}
                                        <td bgcolor="#eab0a9">{{ '%0.2f'| format(input[o]['supercredit'][i]/100 | float) }}</td>
                                        {% else %}
                                        <td>{{ '%0.2f'| format(input[o]['supercredit'][i]/100 | float) }}</td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <div class="col-md-5">
            <div class="jumbotron">
                <div class="row">
                    <br class="col">
                    <div class="row">
                        <div class="col-md-10">
                            <h2>Solution Scenario {{option_array[0]}} - {{data_name[0]}}</h2>
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-primary" id="editData1" name="editData1" type="submit" style="margin-bottom: 20px;">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-4" style="text-align: center">
                                <p class="typA" style="font-size: 12px">Total Profit:
                                    <br>{{'%0.2f'| format(result['totalSales']|float)}}€
                                <br>({{ '%0.2f'| format(((result['totalSales'] - result2['totalSales'])/result['totalSales'])*100|float) }}%)</p>
                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typB" style="font-size: 12px">Total Emission Fine:
                                    <br>-{{'%0.2f'| format(result['emissionRealFine']|float)}}€
                                <br>({{ '%0.2f'| format(((result['emissionRealFine'] - result2['emissionRealFine'])/result['emissionRealFine'])*100|float) }}%)</p>

                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typResult" style="font-size: 12px">Result
                                    <br>{{'%0.2f'| format(result['total']|float)}}€
                                    <br>({{ '%0.2f'| format(((result['total'] - result2['total'])/result['total'])*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">Sold Cars
                                    <br>{{'%0.2f'| format(result['sold']|float)}}
                                <br>({{ '%0.2f'| format(((result['sold'] - result2['sold'])/result['sold'])*100|float) }}%)</p>
                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">WLTP Avg
                                    <br>{{'%0.2f'| format(result['wltpavg']|float)}} gCo2
                                <br>({{ '%0.2f'| format(((result['wltpavg'] - result2['wltpavg'])/result['wltpavg'])*100|float) }}%)</p>
                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">Emission Target
                                    <br>{{'%0.2f'| format(result['emissionlimit']|float)}} gCo2
                                <br>({{ '%0.2f'| format(((result['emissionlimit'] - result2['emissionlimit'])/result['emissionlimit'])*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-6" style="text-align: center">
                                <p class="typA" style="font-size: 12px"> Emission Fine Savings with Supercredits:
                                    <br>{{'%0.2f'| format(saving|float)}}€
                                <br>({{ '%0.2f'| format(((saving - saving2)/saving)*100|float) }}%)</p>
                            </div>
                            <div class="col-md-6" style="text-align: center">
                                <p class="typB" style="font-size: 12px"> Total Emission Fine without Supercredits:
                                    <br>{{'%0.2f'| format(emissionFine_without_supercredit|float)}}€
                                <br>({{ '%0.2f'| format(((emissionFine_without_supercredit - emissionFine_without_supercredit2)/emissionFine_without_supercredit)*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                         <h4>Total Profit per Car</h4>
                        <div class="col-md-12">
                            <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                                <div class="col-md-12" style="padding-left:-100px;">
                                    <canvas id="salesPerProduct" width="100px" height="100px"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Product</th>
                                         {% for p in inputdata['pname'] %}
                                        <th scope="col">{{p}}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row" id="salesProduct">Profit per Product</th>
                                        {% for p in inputdata['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ result['totalSales_perProduct'][i] }}€</td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row" id="salesSingleProduct">Average EB per Single Car</th>
                                        {% for p in inputdata['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format((result['totalSales_perProduct'][i] / result['soldCars'][i]) |float) }}€ </td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row" id="WLTPProduct">WLTP Fine per Product</th>
                                        {% for p in inputdata['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerProduct[i] |float) }}€ </td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row" id="WLTPSingleProduct">WLTP Fine per Single Car</th>
                                        {% for p in inputdata['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerSingleCar[i] |float) }}€ </td>
                                        {% endfor %}
                                    </tr>
                                     <tr>
                                        <th scope="row" id="WLTP_Old_SingleProduct">WLTP Fine without Supercredit per Car</th>
                                        {% for p in inputdata['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerCar_oldWLTP[i] |float) }}€ </td>
                                        {% endfor %}
                                     </tr>
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Produced Cars per Site</h4>
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        {% for p in inputdata['pname'] %}
                                        <th scope="col">{{ p }}</th>
                                        {% endfor %}
                                        <th scope="col" id="capacitySite">Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for s in inputdata['sname'] %} {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ s }}</th>
                                        {% for p in range(0, inputdata['nproducts']) %}
                                        {% if result['produce'][i][p] > 0 %}
                                            <td>{{ result['produce'][i][p] }}
                                            {% if inputdata['nproducts'] == inputdata2['nproducts'] %}
                                                </br>({{ '%0.2f'| format(((result['produce'][i][p] - result2['produce'][i][p] )/result['produce'][i][p] )*100|float) }}%)
                                            {% endif %}
                                            </td>
                                        {% else %}
                                        <td>{{ result['produce'][i][p] }}</td>
                                        {% endif %}
                                        {% endfor %}
                                        <td>{{ result['soldCarsPerSite'][i] }}
                                        {% if (result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i]) >= 0.9 %}
                                            </br><span class="label label-danger" style="font-size: 10px">{{ '%0.2f'| format(((result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        {% if 0.75 <= (result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i]) < 0.9 %}
                                            </br><span class="label label-warning" style="font-size: 10px">{{ '%0.2f'| format(((result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        {% if (result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i]) < 0.75 %}
                                            </br><span class="label label-success" style="font-size: 10px">{{ '%0.2f'| format(((result['soldCarsPerSite'][i] ) /(inputdata['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                            <div class="col-md-12" style="padding-left:-100px;">
                                <canvas id="producedCars" width="100px" height="70px"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Constraints Produced/Delivered Cars</h4>
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        <th scope="col">Minimal Demand</th>
                                        <th scope="col">Produced</th>
                                        <th scope="col">Maximal Possible Value</th>
                                        <th scope="col">Restriction Constraint</th>
                                        <th scope="col" id="domain" style="width:100px">Domain utilization</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in inputdata['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ p }}</th>
                                            <td>{{ result['demand_per_Product'][i] }}</td>
                                            <td>{{ result['soldCars'][i] }}</td>
                                            <td>{{ produceRestriction[i] }}</td>
                                            <td>{{ restrictionConstraint[i] }}</td>
                                            {% if (produceRestriction[i] - result['demand_per_Product'][i]) == 0 %}
                                                <td><span class="label label-danger" style="font-size: 13px">100.00%</span></td>
                                            {% else %}
                                                {% if ((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) >= 0.85 %}
                                                <td><span class="label label-danger" style="font-size: 13px">{{ '%0.2f'| format(((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                                {% if ((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) <= 0.2 %}
                                                <td><span class="label label-success" style="font-size: 13px">{{ '%0.2f'| format(((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                                {% if 0.2 < ((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) < 0.85 %}
                                                <td><span class="label label-warning" style="font-size: 13px">{{ '%0.2f'| format(((result['soldCars'][i] - result['demand_per_Product'][i] ) /(produceRestriction[i] - result['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                            {% endif %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Effects of a single product on the optimal result*</h4>
                        <h8>*Production of all other products remains the same</h8>
                            <div class="col">
                                 <div style="overflow-x:auto;">
                                    <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                        <thead>
                                            <tr>
                                                <th scope="col">Car</th>
                                                {% for p in inputdata['pname'] %}
                                                <th scope="col">{{ p }}</th>
                                                {% endfor %}
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th scope="row">Increase by Ten</th>
                                                {% for p in range(0, inputdata['nproducts']) %}
                                                    <td>{{ '%0.0f'| format(optimumChangePerProductPos[p]| float) }}€
                                                        {% if (produceRestriction[p] - result['soldCars'][p]) < 10 %}
                                                            </br><span style="color:'#ff3300';" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                                        {% else %}
                                                            </br><span class="glyphicon glyphicon-ok" style="color:'#33cc33';" aria-hidden="true"></span>
                                                        {% endif %}</td>
                                                {% endfor %}
                                            </tr>
                                            <tr>
                                                <th scope="row">Decrease by Ten</th>
                                                {% for p in range(0, inputdata['nproducts']) %}
                                                    <td>{{ '%0.0f'| format(optimumChangePerProductNeg[p]| float) }}€
                                                        {% if (result['soldCars'][p] - result['demand_per_Product'][p]) < 10 %}
                                                            </br><span style="color:'#ff3300';" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                                        {% else %}
                                                            </br><span class="glyphicon glyphicon-ok" style="color:'#33cc33';" aria-hidden="true"></span>
                                                        {% endif %}</td>
                                                {% endfor %}
                                            </tr>
                                        </tbody>
                                        </br><span style="color:'#ff3300'" class="glyphicon glyphicon-remove" aria-hidden="true" > Not possible for this solution</span>
                                        </br><span style="color:'#33cc33;" class="glyphicon glyphicon-ok" aria-hidden="true"> Possible for this solution</span>
                                    </table>
                                 </div>
                            </div>
                    </div>
                    <div class="row">
                        <h4>Sold Cars</h4>
                            <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                                <div class="col-md-12" style="padding-left:-100px;">
                                    <canvas id="soldCars1" width="100px" height="70px"></canvas>
                                </div>
                            </div>
                    </div>
                     <div class="row">
                         <h4>Total Profit per Country</h4>
                         <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                            <div class="col-md-12" style="padding-left:-100px;">
                                <canvas id="salesPerCountry" width="400px" height="400px"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Delivery Plan</h4>
                        {% for s in inputdata['sname'] %}
                        {% set i = loop.index - 1%}
                        <div class = "row">
                            <div class="col-md-6" style="padding-left:-100px;">
                                <h4>{{s}}</h4>
                                <canvas id="delivery1_{{i}}" width="70px" height="80px"></canvas>
                            </div>
                            <div class="col-md-6" style="padding-left:-100px;">
                                <div style="overflow-x:auto;">
                                <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                    <thead>
                                        <tr>
                                            <th scope="col">Customers</th>
                                            {% for p in inputdata['pname'] %}
                                            {% set j = loop.index - 1%}
                                            {% if inputdata['productionPlan'][i][j] == 1%}
                                            <th scope="col">{{ p }}</th>
                                            {% endif %}
                                            {% endfor %}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for c in inputdata['cname'] %}
                                        {% set k = loop.index - 1%}
                                        <tr>
                                            <th scope="col">{{c}}</th>
                                            {% for j in range(0, inputdata['nproducts']) %}
                                            {% if inputdata['productionPlan'][i][j] == 1%}
                                            {% if (deliveredRestriction[i][k][j] - inputdata['demand'][k][j]) == 0 %}
                                            <td>{{ result['delivered'][i][k][j] }}
                                                </br><span class="label label-danger" style="font-size: 10px">100.00%</span></td>
                                            {% else %}
                                                <td scope="col">{{ result['delivered'][i][k][j] }}
                                                    {% if ((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) >= 0.85 %}
                                                    </br><span class="label label-danger" style="font-size: 10px"> {{ '%0.2f'| format(((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                                    {% if 0.2 < ((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) < 0.85 %}
                                                    </br><span class="label label-warning" style="font-size: 10px"> {{ '%0.2f'| format(((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                                    {% if ((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) <= 0.2 %}
                                                    </br><span class="label label-success" style="font-size: 10px"> {{ '%0.2f'| format(((result['delivered'][i][k][j] - inputdata['demand'][k][j]) /(deliveredRestriction[i][k][j] - inputdata['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                            {% endif %}
                                            {% endif %}
                                            {% endfor %}
                                        </tr>
                                        {% endfor %}


                                    </tbody>
                                </table>
                             </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        <!--Scenario 2-->
         <div class="col-md-5">
            <div class="jumbotron">
                <div class="row">
                    <br class="col">
                    <div class="row">
                        <div class="col-md-10">
                            <h2>Solution Scenario {{option_array[1]}} - {{data_name[1]}}</h2>
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-primary" id="editData2" name="editData2" type="submit" style="margin-bottom: 20px;">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-4" style="text-align: center">
                                <p class="typA" style="font-size: 12px">Total Profit:
                                    <br>{{'%0.2f'| format(result2['totalSales']|float)}}€
                                <br>({{ '%0.2f'| format(((result2['totalSales'] - result['totalSales'])/result['totalSales'])*100|float) }}%)</p>
                            </div>

                            <div class="col-md-4" style="text-align: center">
                                <p class="typB" style="font-size: 12px">Total Emission Fine:
                                    <br>-{{'%0.2f'| format(result2['emissionRealFine']|float)}}€
                                <br>({{ '%0.2f'| format(((result2['emissionRealFine'] - result['emissionRealFine'])/result['emissionRealFine'])*100|float) }}%)</p>

                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typResult" style="font-size: 12px">Result
                                    <br>{{'%0.2f'| format(result2['total']|float)}}€
                                    <br>({{ '%0.2f'| format(((result2['total'] - result['total'])/result['total'])*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">Sold Cars
                                    <br>{{'%0.2f'| format(result2['sold']|float)}}
                                <br>({{ '%0.2f'| format(((result2['sold'] - result['sold'])/result['sold'])*100|float) }}%)</p>
                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">WLTP Avg
                                    <br>{{'%0.2f'| format(result2['wltpavg']|float)}} gCo2
                                <br>({{ '%0.2f'| format(((result2['wltpavg'] - result['wltpavg'])/result['wltpavg'])*100|float) }}%)</p>
                            </div>
                            <div class="col-md-4" style="text-align: center">
                                <p class="typC" style="font-size: 12px">Emission Target
                                    <br>{{'%0.2f'| format(result2['emissionlimit']|float)}} gCo2
                                <br>({{ '%0.2f'| format(((result2['emissionlimit'] - result['emissionlimit'])/result['emissionlimit'])*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="col-md-6" style="text-align: center">
                                <p class="typA" style="font-size: 12px"> Emission Fine Savings with Supercredits:
                                    <br>{{'%0.2f'| format(saving2|float)}}€
                                <br>({{ '%0.2f'| format(((saving2 - saving)/saving)*100|float) }}%)</p>
                            </div>
                            <div class="col-md-6" style="text-align: center">
                                <p class="typB" style="font-size: 12px"> Total Emission Fine without Supercredits:
                                    <br>{{'%0.2f'| format(emissionFine_without_supercredit2|float)}}€
                                <br>({{ '%0.2f'| format(((emissionFine_without_supercredit2 - emissionFine_without_supercredit)/emissionFine_without_supercredit)*100|float) }}%)</p>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                         <h4>Total Profit per Car</h4>
                        <div class="col-md-12">
                            <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                                <div class="col-md-12" style="padding-left:-100px;">
                                    <canvas id="salesPerProduct2" width="100px" height="100px"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Product</th>
                                         {% for p in inputdata2['pname'] %}
                                        <th scope="col">{{p}}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">Profit per Product</th>
                                        {% for p in inputdata2['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ result2['totalSales_perProduct'][i] }}€ </td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row">Average EB per Single Car</th>
                                        {% for p in inputdata2['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format((result2['totalSales_perProduct'][i] / result2['soldCars'][i]) |float) }}€ </td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row">WLTP Fine per Product</th>
                                        {% for p in inputdata2['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerProduct2[i] |float) }}€</td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row">WLTP Fine per Single Car</th>
                                        {% for p in inputdata2['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerSingleCar2[i] |float) }}€ </td>
                                        {% endfor %}
                                    </tr>
                                    <tr>
                                        <th scope="row" >WLTP Fine without Supercredit per Car</th>
                                        {% for p in inputdata2['pname'] %}
                                            {% set i = loop.index - 1%}
                                        <td>{{ '%0.0f'| format(finePerCar_oldWLTP2[i] |float) }}€ </td>
                                        {% endfor %}
                                     </tr>
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Produced Cars per Site</h4>
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        {% for p in inputdata2['pname'] %}
                                        <th scope="col">{{ p }}</th>
                                        {% endfor %}
                                        <th scope="col">Total</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    {% for s in inputdata2['sname'] %} {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ s }}</th>
                                        {% for p in range(0, inputdata2['nproducts']) %}
                                        {% if inputdata2['nproducts'] != inputdata['nproducts']  %}
                                            <td>{{ result2['produce'][i][p] }}</td>
                                        {% else %}
                                            {% if result2['produce'][i][p] > 0 %}
                                             {% if inputdata['nproducts'] == inputdata2['nproducts'] %}
                                                <td>{{ result2['produce'][i][p] }}
                                                </br>({{ '%0.2f'| format(((result2['produce'][i][p] - result['produce'][i][p] )/result['produce'][i][p] )*100|float) }}%)
                                                {% endif %}
                                                </td>
                                            {% else %}
                                                <td>{{ result2['produce'][i][p] }}</td>
                                            {% endif %}
                                        {% endif %}
                                        {% endfor %}
                                        <td>{{ result2['soldCarsPerSite'][i] }}
                                        {% if (result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i]) >= 0.9 %}
                                            </br><span class="label label-danger" style="font-size: 10px">{{ '%0.2f'| format(((result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        {% if 0.75 <= (result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i]) < 0.9 %}
                                            </br><span class="label label-warning" style="font-size: 10px">{{ '%0.2f'| format(((result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        {% if (result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i]) < 0.75 %}
                                            </br><span class="label label-success" style="font-size: 10px">{{ '%0.2f'| format(((result2['soldCarsPerSite'][i] ) /(inputdata2['maxProduction'][i])) *100|float) }} %</span>
                                        {% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                            <div class="col-md-12" style="padding-left:-100px;">
                                <canvas id="producedCars2" width="100px" height="70px"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Constraints Produced/Delivered Cars</h4>
                        <div class="col">
                            <div style="overflow-x:auto;">
                            <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Car</th>
                                        <th scope="col">Minimal Demand</th>
                                        <th scope="col">Produced</th>
                                        <th scope="col">Maximal Possible Value</th>
                                        <th scope="col">Restriction Constraint</th>
                                        <th scope="col" style="width:100px">Domain utilization</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for p in inputdata2['pname'] %}
                                    {% set i = loop.index - 1%}
                                    <tr>
                                        <th scope="row">{{ p }}</th>
                                            <td>{{ result2['demand_per_Product'][i] }}</td>
                                            <td>{{ result2['soldCars'][i] }}</td>
                                            <td>{{ produceRestriction2[i] }}</td>
                                            <td>{{ restrictionConstraint2[i] }}</td>
                                            {% if (produceRestriction2[i] - result2['demand_per_Product'][i]) == 0 %}
                                                <td><span class="label label-danger" style="font-size: 13px">100.00%</span></td>
                                            {% else %}
                                                {% if ((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) >= 0.85 %}
                                                <td><span class="label label-danger" style="font-size: 13px">{{ '%0.2f'| format(((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                                {% if ((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) <= 0.2 %}
                                                <td><span class="label label-success" style="font-size: 13px">{{ '%0.2f'| format(((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                                {% if 0.2 < ((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) < 0.85 %}
                                                <td><span class="label label-warning" style="font-size: 13px">{{ '%0.2f'| format(((result2['soldCars'][i] - result2['demand_per_Product'][i] ) /(produceRestriction2[i] - result2['demand_per_Product'][i])) *100|float) }} %</span></td>
                                                {% endif %}
                                            {% endif %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Effects of a single product on the optimal result*</h4>
                        <h8>*Production of all other products remains the same</h8>
                        <div class="col">
                             <div style="overflow-x:auto;">
                                <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                    <thead>
                                        <tr>
                                            <th scope="col">Car</th>
                                            {% for p in inputdata2['pname'] %}
                                            <th scope="col">{{ p }}</th>
                                            {% endfor %}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">Increase by Ten</th>
                                            {% for p in range(0, inputdata2['nproducts']) %}
                                                <td>{{ '%0.0f'| format(optimumChangePerProductPos2[p]| float) }}€
                                                    {% if (produceRestriction2[p] - result2['soldCars'][p]) < 10 %}
                                                        </br><span style="color:'#ff3300';" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                                    {% else %}
                                                        </br><span class="glyphicon glyphicon-ok" style="color:'#33cc33';" aria-hidden="true"></span>
                                                    {% endif %}</td>
                                            {% endfor %}
                                        </tr>
                                        <tr>
                                            <th scope="row">Decrease by Ten</th>
                                            {% for p in range(0, inputdata2['nproducts']) %}
                                                <td>{{ '%0.0f'| format(optimumChangePerProductNeg2[p]| float) }}€
                                                    {% if (result2['soldCars'][p] - result2['demand_per_Product'][p]) < 10 %}
                                                        </br><span style="color:'#ff3300';" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                                    {% else %}
                                                        </br><span class="glyphicon glyphicon-ok" style="color:'#33cc33';" aria-hidden="true"></span>
                                                    {% endif %}</td>
                                            {% endfor %}
                                        </tr>
                                    </tbody>
                                    </br><span style="color:'#ff3300'" class="glyphicon glyphicon-remove" aria-hidden="true" > Not possible for this solution</span>
                                    </br><span style="color:'#33cc33;" class="glyphicon glyphicon-ok" aria-hidden="true"> Possible for this solution</span>
                                </table>
                             </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Sold Cars</h4>
                        <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                            <div class="col-md-12" style="padding-left:-100px;">
                                <canvas id="soldCars2" width="100px" height="70px"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                         <h4>Total Profit per Country</h4>
                         <div class="chart-container" style="position: relative; height:10vh; width:30vw">
                            <div class="col-md-12" style="padding-left:-100px;">
                                <canvas id="salesPerCountry2" width="400px" height="400px"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <h4>Delivery Plan</h4>
                        {% for s in inputdata2['sname'] %}
                        {% set i = loop.index - 1%}
                        <div class = "row">
                            <div class="col-md-6" style="padding-left:-100px;">
                                <h4>{{s}}</h4>
                                <canvas id="delivery2_{{i}}" width="70px" height="80px"></canvas>
                            </div>
                            <div class="col-md-6" style="padding-left:-100px;">
                                <div style="overflow-x:auto;">
                                <table class="table table-striped table-sm table-nowrap table-centered mb-0">
                                    <thead>
                                        <tr>
                                            <th scope="col">Customers</th>
                                            {% for p in inputdata2['pname'] %}
                                            {% set j = loop.index - 1%}
                                            {% if inputdata2['productionPlan'][i][j] == 1%}
                                            <th scope="col">{{ p }}</th>
                                            {% endif %}
                                            {% endfor %}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for c in inputdata2['cname'] %}
                                        {% set k = loop.index - 1%}
                                        <tr>
                                            <th scope="col">{{c}}</th>
                                            {% for j in range(0, inputdata2['nproducts']) %}
                                            {% if inputdata2['productionPlan'][i][j] == 1%}
                                            {% if (deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j]) == 0 %}
                                                <td>{{ result2['delivered'][i][k][j] }}
                                                </br><span class="label label-danger" style="font-size: 10px">100.00%</span></td>
                                            {% else %}
                                                <td scope="col">{{ result2['delivered'][i][k][j] }}
                                                    {% if ((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) >= 0.85 %}
                                                    </br><span class="label label-danger" style="font-size: 10px"> {{ '%0.2f'| format(((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                                    {% if 0.2 < ((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) < 0.85 %}
                                                    </br><span class="label label-warning" style="font-size: 10px"> {{ '%0.2f'| format(((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                                    {% if ((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) <= 0.2 %}
                                                    </br><span class="label label-success" style="font-size: 10px"> {{ '%0.2f'| format(((result2['delivered'][i][k][j] - inputdata2['demand'][k][j]) /(deliveredRestriction2[i][k][j] - inputdata2['demand'][k][j])) *100|float) }} %</span></td>
                                                    {% endif %}
                                            {% endif %}
                                            {% endif %}
                                            {% endfor %}
                                        </tr>
                                        {% endfor %}


                                    </tbody>
                                </table>
                             </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>


       </div>
  </div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>

                    <script>
                                var ctx = document.getElementById('salesPerCountry');
                                var myChart = new Chart(ctx, {
                                type: 'polarArea',
                                data: {
                                    labels: [
                                          {% for c in inputdata['cname'] %}
                                           "{{ c }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        data: [
                                            {% for i in result['totalSales_perCustomer'] %}
                                                "{{ i }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },

                                    options: {
                                        legend: {
                                            display: true,
                                            position: 'bottom',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },

                                    }
                                });

                                 var ctx = document.getElementById('salesPerCountry2');
                                var myChart = new Chart(ctx, {
                                type: 'polarArea',
                                data: {
                                    labels: [
                                          {% for c in inputdata2['cname'] %}
                                           "{{ c }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        data: [
                                            {% for i in result2['totalSales_perCustomer'] %}
                                                "{{ i }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },

                                    options: {
                                        legend: {
                                            display: true,
                                            position: 'bottom',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },

                                    }
                                });

                                var ctx = document.getElementById('salesPerProduct');
                                var myChart = new Chart(ctx, {
                                type: 'polarArea',
                                data: {
                                    labels: [
                                          {% for p in inputdata['pname'] %}
                                           "{{ p }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        data: [
                                            {% for i in result['totalSales_perProduct'] %}
                                                "{{ i }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },

                                    options: {
                                        legend: {
                                            display: true,
                                            position: 'bottom',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },

                                    }
                                });

                                var ctx = document.getElementById('salesPerProduct2');
                                var myChart = new Chart(ctx, {
                                type: 'polarArea',
                                data: {
                                    labels: [
                                          {% for p in inputdata2['pname'] %}
                                           "{{ p }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        data: [
                                            {% for i in result2['totalSales_perProduct'] %}
                                                "{{ i }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },

                                    options: {
                                        legend: {
                                            display: true,
                                            position: 'bottom',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },

                                    }
                                });


                                var ctx = document.getElementById('soldCars1');
                                var myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: [
                                          {% for p in inputdata['pname'] %}
                                           "{{ p }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        label: '# of Cars',
                                        data: [
                                            {% for s in result['soldCars'] %}
                                                "{{ s }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },
                                    options: {
                                        legend: {
                                            display: false,
                                            position: 'top',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        scales: {
                                            yAxes: [{
                                                ticks: {
                                                    beginAtZero: true,
                                                    max: Math.max.apply(this, {{produceRestriction}}, {{produceRestriction2}}) + 100
                                                }
                                            }]
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },
                                        "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                            this.data.datasets.forEach(function(dataset, i) {
                                              var meta = chartInstance.controller.getDatasetMeta(i);
                                              meta.data.forEach(function(bar, index) {
                                                var data = dataset.data[index];
                                                ctx.fillText(data, bar._model.x, bar._model.y - 5);
                                              });
                                            });
                                          }
                                        },
                                    }
                                });

                                <!--Table Sold Cars 2-->
                                var ctx = document.getElementById('soldCars2');
                                var myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: [
                                          {% for p in inputdata2['pname'] %}
                                           "{{ p }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        label: '# of Cars',
                                        data: [
                                            {% for s in result2['soldCars'] %}
                                                "{{ s }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },
                                    options: {
                                        legend: {
                                            display: false,
                                            position: 'top',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        scales: {
                                            yAxes: [{
                                                ticks: {
                                                    beginAtZero: true,
                                                    max: Math.max.apply(this, {{produceRestriction}}, {{produceRestriction2}}) + 100
                                                }
                                            }]
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },
                                        "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                            this.data.datasets.forEach(function(dataset, i) {
                                              var meta = chartInstance.controller.getDatasetMeta(i);
                                              meta.data.forEach(function(bar, index) {
                                                var data = dataset.data[index];
                                                ctx.fillText(data, bar._model.x, bar._model.y - 5);
                                              });
                                            });
                                          }
                                        },
                                    }
                                });

                                <!--wltp inputdata 1-->
                                {% for options in options %}
                                {% set t = loop.index%}
                                var ctx = document.getElementById('wltp{{t}}');
                                var myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: [
                                          {% for p in input[options]['pname'] %}
                                           "{{ p }}",
                                          {% endfor %}
                                    ],
                                    datasets: [{
                                        label: 'WLTP of Cars',
                                        data: [
                                            {% for w in input[options]['emissionWLTP'] %}
                                                "{{ w }}",
                                             {% endfor %}],
                                        backgroundColor: [
                                            {% for c in colors %}
                                                '{{ c }}',
                                            {% endfor %}
                                            ],
                                            borderColor: [
                                            ],
                                            borderWidth: 1
                                        }]
                                    },
                                    options: {
                                        legend: {
                                            display: false,
                                            position: 'bottom',
                                            labels: {
                                                fontColor: 'rgb(071, 071, 071)'
                                            }
                                        },
                                        scales: {
                                            yAxes: [{
                                                ticks: {
                                                    beginAtZero: true,
                                                    max: Math.max.apply(this, {{input[options]['emissionWLTP']}}) + 100
                                                }
                                            }]
                                        },
                                        layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 15,
                                                bottom: 0
                                            }
                                        },
                                        "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                            this.data.datasets.forEach(function(dataset, i) {
                                              var meta = chartInstance.controller.getDatasetMeta(i);
                                              meta.data.forEach(function(bar, index) {
                                                var data = dataset.data[index];
                                                ctx.fillText(data, bar._model.x, bar._model.y - 5);
                                              });
                                            });
                                          }
                                        },
                                    }
                                });
                                {% endfor %}

                                Chart.defaults.groupableBar = Chart.helpers.clone(Chart.defaults.bar);

                            var helpers = Chart.helpers;
                            Chart.controllers.groupableBar = Chart.controllers.bar.extend({
                              calculateBarX: function (index, datasetIndex) {
                                // position the bars based on the stack index
                                var stackIndex = this.getMeta().stackIndex;
                                return Chart.controllers.bar.prototype.calculateBarX.apply(this, [index, stackIndex]);
                              },

                              hideOtherStacks: function (datasetIndex) {
                                var meta = this.getMeta();
                                var stackIndex = meta.stackIndex;

                                this.hiddens = [];
                                for (var i = 0; i < datasetIndex; i++) {
                                  var dsMeta = this.chart.getDatasetMeta(i);
                                  if (dsMeta.stackIndex !== stackIndex) {
                                    this.hiddens.push(dsMeta.hidden);
                                    dsMeta.hidden = true;
                                  }
                                }
                              },

                              unhideOtherStacks: function (datasetIndex) {
                                var meta = this.getMeta();
                                var stackIndex = meta.stackIndex;

                                for (var i = 0; i < datasetIndex; i++) {
                                  var dsMeta = this.chart.getDatasetMeta(i);
                                  if (dsMeta.stackIndex !== stackIndex) {
                                    dsMeta.hidden = this.hiddens.unshift();
                                  }
                                }
                              },

                              calculateBarY: function (index, datasetIndex) {
                                this.hideOtherStacks(datasetIndex);
                                var barY = Chart.controllers.bar.prototype.calculateBarY.apply(this, [index, datasetIndex]);
                                this.unhideOtherStacks(datasetIndex);
                                return barY;
                              },

                              calculateBarBase: function (datasetIndex, index) {
                                this.hideOtherStacks(datasetIndex);
                                var barBase = Chart.controllers.bar.prototype.calculateBarBase.apply(this, [datasetIndex, index]);
                                this.unhideOtherStacks(datasetIndex);
                                return barBase;
                              },

                              getBarCount: function () {
                                var stacks = [];

                                // put the stack index in the dataset meta
                                Chart.helpers.each(this.chart.data.datasets, function (dataset, datasetIndex) {
                                  var meta = this.chart.getDatasetMeta(datasetIndex);
                                  if (meta.bar && this.chart.isDatasetVisible(datasetIndex)) {
                                    var stackIndex = stacks.indexOf(dataset.stack);
                                    if (stackIndex === -1) {
                                      stackIndex = stacks.length;
                                      stacks.push(dataset.stack);
                                    }
                                    meta.stackIndex = stackIndex;
                                  }
                                }, this);

                                this.getMeta().stacks = stacks;
                                return stacks.length;
                              },
                            });
                            var data = {
                              labels: [
                                      {% for s in inputdata['sname'] %}
                                        "{{ s }}",
                                      {% endfor %}
                              ],
                              datasets: [
                                {% for p in inputdata['pname'] %}
                                {% set i = loop.index - 1%}
                                      {
                                          label: "{{ p }}",
                                          backgroundColor: "{{colors[i]}}",
                                          data:
                                          [{% for s in range(0, inputdata['nsites']) %}
                                            {{ result['produce'][s][i] }},
                                          {% endfor %}],
                                          stack: 1
                                      },
                                {% endfor %}
                              ]
                            };

                            var ctx = document.getElementById("producedCars").getContext("2d");
                            new Chart(ctx, {
                              type: 'groupableBar',
                              data: data,
                              options: {
                                legend: {
                                  display: true,
                                  position: 'bottom',
                                  labels: {
                                       fontColor: 'rgb(071, 071, 071)'
                                      }
                                    },
                                    layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 10,
                                                bottom: 20
                                            }
                                    },
                                    "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                           this.data.datasets[0].data.forEach(function(data, index) {
                                           var total = data;
                                           var i = 0;
                                           {% for s in range(1, inputdata['nproducts']) %}
                                                i = i + 1;
                                                total = total + this.data.datasets[{{s}}].data[index];
                                           {% endfor %}
                                           var meta = chartInstance.controller.getDatasetMeta(i);
                                           var posX = meta.data[index]._model.x;
                                           var posY = meta.data[index]._model.y;
                                           ctx.fillStyle = 'black';
                                           ctx.fillText(total, posX , posY);
                                        }, this);
                                          }
                                     },
                                    scales: {
                                      yAxes: [{
                                        ticks: {
                                          beginAtZero: true,
                                          max: Math.max.apply(this, {{produceRestriction}}, {{produceRestriction2}}) + 1000
                                        },
                                        stacked: true,
                                      }]
                                    },
                              }
                            });

                            var data2 = {
                              labels: [
                                      {% for s in inputdata2['sname'] %}
                                        "{{ s }}",
                                      {% endfor %}
                              ],
                              datasets: [
                                {% for p in inputdata2['pname'] %}
                                {% set i = loop.index - 1%}
                                      {
                                          label: "{{ p }}",
                                          backgroundColor: "{{colors[i]}}",
                                          data:
                                          [{% for s in range(0, inputdata2['nsites']) %}
                                            {{ result2['produce'][s][i] }},
                                          {% endfor %}],
                                          stack: 1
                                      },
                                {% endfor %}
                              ]
                            };

                            var ctx = document.getElementById("producedCars2").getContext("2d");
                            new Chart(ctx, {
                              type: 'groupableBar',
                              data: data2,
                              options: {
                                legend: {
                                  display: true,
                                  position: 'bottom',
                                  labels: {
                                       fontColor: 'rgb(071, 071, 071)'
                                      }
                                    },
                                    layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 10,
                                                bottom: 20
                                            }
                                    },
                                    "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                           this.data.datasets[0].data.forEach(function(data, index) {
                                           var total = data;
                                           var i = 0;
                                           {% for s in range(1, inputdata2['nproducts']) %}
                                                i = i +1;
                                                total = total + this.data.datasets[{{s}}].data[index];
                                           {% endfor %}
                                           var meta = chartInstance.controller.getDatasetMeta(i);
                                           var posX = meta.data[index]._model.x;
                                           var posY = meta.data[index]._model.y;
                                           ctx.fillStyle = 'black';
                                           ctx.fillText(total, posX , posY);
                                        }, this);
                                          }
                                        },
                                    scales: {
                                      yAxes: [{
                                        ticks: {
                                          beginAtZero: true,
                                          max: Math.max.apply(this, {{produceRestriction}}, {{produceRestriction2}}) + 1000
                                        },
                                        stacked: true,
                                      }]
                                    },
                              }
                            });


                            {% for s in inputdata2['sname'] %}
                            {% set si = loop.index - 1%}
                             var data_2_{{s}} = {
                              labels: [
                                      {% for c in inputdata2['cname'] %}
                                        "{{ c }}",
                                      {% endfor %}
                              ],
                              datasets: [
                                {% for p in inputdata2['pname'] %}
                                {% set pi = loop.index - 1%}
                                      {
                                          label: "{{ p }}",
                                          backgroundColor: "{{colors[pi]}}",
                                          data:
                                          [{% for c in range(0, inputdata2['ncustomers']) %}
                                            {{ result2['delivered'][si][c][pi] }},
                                          {% endfor %}],
                                          stack: 1
                                      },
                                {% endfor %}
                              ]
                            };

                            var ctx = document.getElementById("delivery2_{{si}}").getContext("2d");
                            new Chart(ctx, {
                              type: 'groupableBar',
                              data: data_2_{{s}},
                              options: {
                                legend: {
                                  display: false,
                                  position: 'right',
                                  labels: {
                                       fontColor: 'rgb(071, 071, 071)'
                                      }
                                    },
                                    layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 10,
                                                bottom: 20
                                            }
                                    },
                                    "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                            "duration": 1,
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';

                                           this.data.datasets[0].data.forEach(function(data, index) {
                                           var total = data;
                                           var i = 0;
                                           {% for s in range(1, inputdata2['nproducts']) %}
                                                i = i + 1;
                                                total = total + this.data.datasets[{{s}}].data[index];
                                           {% endfor %}
                                           var meta = chartInstance.controller.getDatasetMeta(i);
                                           var posX = meta.data[index]._model.x;
                                           var posY = meta.data[index]._model.y;
                                           ctx.fillStyle = 'black';
                                           ctx.fillText(total, posX , posY);
                                        }, this);
                                          }
                                        },
                                    scales: {
                                      yAxes: [{
                                        ticks: {
                                          beginAtZero: true,
                                          max: Math.max.apply(this, {{result['soldCars']}}, {{result2['soldCars']}})
                                        },
                                        stacked: true,
                                      }]
                                    }
                              }
                            });
                            {% endfor %}



                            {% for s in inputdata['sname'] %}
                            {% set si = loop.index - 1%}
                             var data_1_{{s}} = {
                              labels: [
                                      {% for c in inputdata['cname'] %}
                                        "{{ c }}",
                                      {% endfor %}
                              ],
                              datasets: [
                                {% for p in inputdata['pname'] %}
                                {% set pi = loop.index - 1%}
                                      {
                                          label: "{{ p }}",
                                          backgroundColor: "{{colors[pi]}}",
                                          data:
                                          [{% for c in range(0, inputdata['ncustomers']) %}
                                            {{ result['delivered'][si][c][pi] }},
                                          {% endfor %}],
                                          stack: 1
                                      },
                                {% endfor %}
                              ]
                            };

                            var ctx = document.getElementById("delivery1_{{si}}").getContext("2d");
                            new Chart(ctx, {
                              type: 'groupableBar',
                              data: data_1_{{s}},
                              options: {
                                legend: {
                                  display: false,
                                  position: 'right',
                                  labels: {
                                       fontColor: 'rgb(071, 071, 071)'
                                      }
                                    },
                                    layout: {
                                            padding: {
                                                left: 0,
                                                right: 0,
                                                top: 10,
                                                bottom: 20
                                            }
                                    },
                                    "hover": {
                                            "animationDuration": 0
                                        },
                                         animation: {
                                          "onComplete": function() {
                                            var chartInstance = this.chart,
                                              ctx = chartInstance.ctx;

                                           ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);
                                           ctx.textAlign = 'center';
                                           ctx.textBaseline = 'bottom';

                                           this.data.datasets[0].data.forEach(function(data, index) {
                                           var total = data;
                                           var i = 0;
                                           {% for s in range(1, inputdata['nproducts']) %}
                                                i = i + 1;
                                                total = total + this.data.datasets[{{s}}].data[index];
                                           {% endfor %}
                                           var meta = chartInstance.controller.getDatasetMeta(i);
                                           var posX = meta.data[index]._model.x;
                                           var posY = meta.data[index]._model.y;
                                           ctx.fillStyle = 'black';
                                           ctx.fillText(total, posX , posY);
                                        }, this);
                                          }
                                        },
                                    scales: {
                                      yAxes: [{
                                        ticks: {
                                          beginAtZero: true,
                                          max: Math.max.apply(this, {{result['soldCars']}}, {{result2['soldCars']}})
                                        },
                                        stacked: true,
                                      }]
                                    }
                              }
                            });
                            {% endfor %}

                            $(function() {
                              $('#colorselector').change(function(){
                                $('.colors').hide();
                                $('#' + $(this).val()).show();
                              });
                            });

                    </script>
</form>
{% endblock %}